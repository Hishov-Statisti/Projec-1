---
title: "Project 1 - Alon Goodman & Ran Hassid"
output:
  html_document:
    df_print: paged
---

# Q1 - Snakes & Ladders #

## The Board Game ##

```{r}
Start_of_Ladder <- c(2,7,8,15,21,28,36,51,71,78,87)
End_of_Ladder <- c(38,14,31,26,42,84,44,66,91,98,94)
Start_of_Snake <- c(16,46,49,62,64,74,89,92,99)
End_of_Snake <- c(6,25,11,19,60,53,68,88,80)
```



## Auxiliary Function - Sum of Digit ##

```{r}
digitsum <- function(n) {
  while(n>=10){
  n <-n %% 10 + floor(n / 10)
  }
  return(n)
  }
```

## One game Function ##

1. Rolling the dice.
2. Check if we crossed the 100 and go back.
3. Check if the final sum of digits is equal to value of the dice.
4. Handle the snakes and ladders.

```{r}
Sanke_and_Ladder <- function(Start_of_Ladder,End_of_Ladder,Start_of_Snake,End_of_Snake){
  Snake <- data.frame(Start_of_Snake,End_of_Snake)
  Ladder <- data.frame(Start_of_Ladder,End_of_Ladder)
  number_of_rolls <- 0
  counter <- 1
  while(counter < 100){
    dice_roll <- sample(1:6,1) 
    number_of_rolls <-  number_of_rolls + 1
    counter <- counter + dice_roll
    if (counter > 100){
      dif <- counter - 100
      counter <- 100 - dif
      }
    if (digitsum(counter) == dice_roll){
      counter <- floor(counter/2)
      }
    if  (any(counter==Snake$Start_of_Snake)==T){
      counter <- Snake$End_of_Snake[Snake$Start_of_Snake == counter]}
    if  (any(counter==Ladder$Start_of_Ladder)==T){
      counter <- Ladder$End_of_Ladder[Ladder$Start_of_Ladder == counter]}
    }
  return (number_of_rolls)
}
```

## The Simulation ##
```{r}
Sanke_and_Ladder_sim <- replicate(5000,Sanke_and_Ladder(Start_of_Ladder,End_of_Ladder,Start_of_Snake,End_of_Snake))
```

### The Expected value ###
```{r}
mu <- mean(Sanke_and_Ladder_sim)
mu
```

### Confidance Interval of 95% - CLT ###
```{r}
sd <- sqrt(var(Sanke_and_Ladder_sim)/5000)
up <- mu + qnorm(0.975)*sd
low <- mu - qnorm(0.975)*sd
CI <- c(low,up)
CI
```

# Q2 - X & O #


# Q3 - Dogcatia #

1. r - counter for the turn - total
2. r.d - counter for dogs in the turn
3. r.c - counter for cats in the turn
4. X - dogs come - Poisson(lambda=3)
5. Y - cats come - Poisson(lambda=1.5) - a cat enter the turn if and only if r=0   
6. X.1 - dogs service - exp(mu=3)
7. Y.1 - cats service - exp(mu=5)
8. Only one server - one animal is served at time
9. p.d - profit from dog - 1, damage from dog - 0.1
10. p.c - profit from cat - 3
11. total time - 12 hours = 720 minutes. t.counter - clock counter

```{r}
dogcatia <- function(){
  t.counter <- 0 # clock counter
  r <- 0 # counter for the  total turn
  r.d <- 0 # counter for dogs in the turn
  r.c <- 0 # counter for cats in the turn
  r.d.y <- 0 # counter for dogs that was served
  r.d.n <- 0 # counter for dogs that was not served
  r.c.y <- 0 # counter for cats that was served
  r.c.n <- 0 # counter for cats that was not served
  p.d <- 0 # profit from dog
  p.c <- 0 # profit from cat
  next_turn <-c(rep("0",10))
  turn_df <- data.frame(next_turn)
  
  
  X <- numeric(0)
  while (sum(X)<720) {
    X <- c(X,rexp(n = 1,rate = 3))
  }
  Y <- numeric(0)
  while (sum(Y)<720) {
    Y <- c(Y,rexp(n = 1,rate = 1.5))
  }
  
  X <- cumsum(x = X) # dogs arrive time 
  Y <- cumsum(x = Y) # cats arrive time
  
  ##################################################################33
  # an animal enter the turn
  
  
  for (i in 1:720) {
    if(r<10){
      for(j in range((sum(1==x)))){
        turn_df[r+j,r+j] <- "dog"
      }
      turn_df <- turn_df[c(1:10),]
      r.d <- r.d + sum(i==X)
      r <- r + sum(i==X)
      if (r>10) {
        r.d <- r.d - (r-10)
        r <- 10
      }
      t.counter <- t.counter + sum(i==X) ??????????????
      }else{
        r.d.n <- r.d.n + 1
      }
    if (r>0){
        r.c.n <- r.c.n + 1
      }else{
        r.c <- r.c + sum(i==Y)
        turn_df[r+1,r+1] <-  "cat"
        t <- t + y
        }
    
    
    if () {
      
    }
    r.d <- r.d + sum(i==X)
    r.c <- r.c + sum(i==Y)
    
    
    
  }
  
}
```








```{r}
z <- c(1:10)
z.1 <- c(rep("0",5),rep("1",5))
g <- data.frame(z,z.1)
g[1,1] <- 2
g[1,2] <- "dog"
g[2,1] <- 2
g[2,2] <- "cat"
g
g <- g[-c(1),]
g
g[nrow(g)+1,] <- c(0,"0")
g <- g[c(1:10),]

```



```{r}

animal_comes <- func() {
   x <- rpois(1,3)
   y <- rpois(1,1.5)
   if (y<=x){
     if (r>0){
       r.c.n <- r.c.n + 1
       }else{
         r.c <- r.c + 1
         turn_df[r+1,r+1] <-  "cat"
         t.counter <- t.counter + y
         }
     if(r<10){
       r.d <- r.d + 1
       turn_df[r+1,r+1] <- "dog"
       t.counter <- t.counter + x
       }else{
         r.d.n <- r.d.n + 1
       }
     }
   if (y>x){
     if(r<10){
       r.d <- r.d + 1
       turn_df[r+1,r+1] <- "dog"
       t.counter <- t.counter + x
       }else{
        r.d.n <- r.d.n + 1
        }
     if (r>0){
       r.c.n <- r.c.n + 1
       }else{
         r.c <- r.c + 1
         turn_df[r+1,r+1] <-  "cat"
         t.counter <- t.counter + y
       }
   }
   }




while(t<720){
    # an animal comes
    x <- rpois(1,3)
    y <- rpois(1,1.5)
    if(r<10){
      r.d <- r.d + 1
      turn_df[r+1,r+1] <- "dog"
      t.counter <- t.counter + x
      }else{
        r.d.n <- r.d.n + 1
        }
    if (r>0){
      r.c.n <- r.c.n + 1
    }else{
      r.c <- r.c + 1
      turn_df[r+1,r+1] <-  "cat"
      t.counter <- t.counter + y
      }
  }
    # server an animal
    if(turn_df[1,1]=="dog"){
      x.1 <- rexp(1,3)
    }
  
```

